<body>
  <ul>
    <li>
      This is a page rendered using wpmjs to load a remote npm package. The module-federation module mf-app-01 and the umd module antd are used respectively. They can share npm's react or react in shared. You can use (await wpmjs.import("antd")).Button or await wpmjs.import("mf-app-01/App") in the chrome console to get the remote component
    </li>
    <li>
      The wpm debugging panel on the right can automatically connect to the locally started dev-server that meets the specifications, and can also set the version of the remote module for debugging. You can set react 18.1.0 in alias to try it.
    </li>
    <li>
      （pending upgrade）see <a href="https://github.com/zhangHongEn/universal-module-federation-plugin/tree/main/packages/wpmjs">wpmjs</a> and <a href="https://github.com/zhangHongEn/universal-module-federation-plugin/tree/main/packages/npm-federation-webpack">npm-federation</a>
    </li>
    <li onclick="localStorage.clear();location.reload()">
      <a href="#">clear cache</a>
    </li>
  </ul>
  <script src="https://assets.weimob.com/module-federation-runtime/dist/umd/index.js"></script>
  <script src="https://assets.weimob.com/wpmjs@4"></script>
  <script>
  const wpmjs = window.wpmjs
  
  const wpmjs1 = new wpmjs.constructor({
    name: "wpmjs1"
  })
  
  wpmjs.setConfig({
    baseUrl: "https://assets.weimob.com",
  })
  
  wpmjs.addImportMap({
    "antd": "antd@5.9.0/dist/antd.js",
    "dayjs": "dayjs@1.11.1",
    "react-dom": {
      "packageVersion": "18.2.0",
      // strictVersion: true
    },
    "react": {
      "packageVersion": "18.2.0"
    },
  })
  wpmjs.addImportMap({
    "react-dom": "react-dom/umd/react-dom.development.js",
    "react": "react/umd/react.development.js",
    "mf-app-01": {
      package: "mf-app-01/dist/remoteEntry.js",
      global: "mfapp01"
    }
  })
  
  // 卡住两次wpmjs的加载
  // window.wpmjs.sleep(new Promise(resolve => {
  //   setTimeout(() => {
  //     resolve()
  //     window.wpmjs.sleep(new Promise(resolve => {
  //       setTimeout(() => {
  //         resolve()
  //       }, 1000)
  //     }))
  //   }, 1000);
  // }))
  
  ;(async function main() {
    const [React, reactDom] = await Promise.all(["react", "react-dom"].map(pkg => wpmjs.import(pkg)));
    const [
      dayjs
    ] = await Promise.all(["dayjs"].map(pkg => wpmjs.import(pkg)));
    window.dayjs = dayjs
    const [
      App1,
      antd,
    ] = await Promise.all(["mf-app-01/App", "antd"].map(pkg => wpmjs.import(pkg)));
  
    const div = document.createElement("div")
    document.body.appendChild(div)
    reactDom.render(React.createElement("div", {}, [
      React.createElement(App1.default),
      React.createElement(antd.Divider),
      React.createElement("div", {
        style: {
          padding: 40,
          background: "cyan",
        }
      }, [
        React.createElement("span", { style: {paddingRight: 20, fontSize: 24, fontWeight: 700 } }, ["umd remote module:"]),
        React.createElement(antd.DatePicker.RangePicker, {
          placeholder: ["antd", "RangePicker"],
        }),
        React.createElement(antd.Button, {}, ["antd button"]),
        React.createElement("span", { style: {paddingLeft: 20, fontSize: 24, fontWeight: 700 } }, ["react version:" + React.version]),
      ]),
    ]), div)
  })();
  wpmjs.debug({
    baseUrl: "https://assets.weimob.com"
  })
  </script>
</body>